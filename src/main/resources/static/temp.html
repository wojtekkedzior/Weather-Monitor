<!DOCTYPE HTML>
<html>
<head>
<script>
	window.onload = function() {

		updateChart();

		function updateChart() {
			$
					.ajax({
						type : 'GET',
						url : 'http://192.168.0.17:8080/temperature',
						data : {},
						dataType : 'json',
						success : function(data) {
							var temperature = [];

							$.each(data, function(index, element) {
								temperature.push({
									x : new Date(data[index].time),
									y : data[index].temperature
								});
							});

							//console.log(dataps);
							var chart = new CanvasJS.Chart(
									"chartContainer",
									{
										animationEnabled : true,
										title : {
											text : "Daily High Temperature at Different Beaches"
										},
										axisX : {
											//valueFormatString: "DD MMM,YY"
											valueFormatString : "HH mm ss"
										},
										axisY : {
											title : "Temperature (in 째C)",
											includeZero : true,
											suffix : " 째C"
										},
										legend : {
											cursor : "pointer",
											fontSize : 16,
											itemclick : toggleDataSeries
										},
										toolTip : {
											shared : true
										},
										data : [ {
											name : "Temerature",
											type : "spline",
											yValueFormatString : "#0.## C",
											showInLegend : true,
											dataPoints : temperature
										} ]
									});
							chart.render();
						}
					});

			$
					.ajax({
						type : 'GET',
						url : 'http://192.168.0.17:8080/temperature',
						data : {},
						dataType : 'json',
						success : function(data) {
							var humidity = [];

							$.each(data, function(index, element) {
								humidity.push({
									x : new Date(data[index].time),
									y : data[index].humidity
								});
							});

							var chart = new CanvasJS.Chart(
									"chartContainer2",
									{
										animationEnabled : true,
										title : {
											text : "Daily High Temperature at Different Beaches"
										},
										axisX : {
											//valueFormatString: "DD MMM,YY"
											valueFormatString : "HH mm ss"
										},
										axisY : {
											title : "Humidity (in %)",
											includeZero : true,
											suffix : " 째C"
										},
										legend : {
											cursor : "pointer",
											fontSize : 16,
											itemclick : toggleDataSeries
										},
										toolTip : {
											shared : true
										},
										data : [ {
											name : "Humidity",
											type : "spline",
											yValueFormatString : "#0.## '%'",
											showInLegend : true,
											dataPoints : humidity
										} ]
									});
							chart.render();
						}
					});

			$
					.ajax({
						type : 'GET',
						url : 'http://192.168.0.17:8080/temperature',
						data : {},
						dataType : 'json',
						success : function(data) {
							var pressure = [];

							$.each(data, function(index, element) {

								pressure.push({
									x : new Date(data[index].time),
									y : data[index].pressure
								});
							});

							var chart = new CanvasJS.Chart(
									"chartContainer3",
									{
										animationEnabled : true,
										title : {
											text : "Daily High Temperature at Different Beaches"
										},
										axisX : {
											//valueFormatString: "DD MMM,YY"
											valueFormatString : "HH mm ss"
										},
										axisY : {
											title : "Pressure (in hPa)",
											includeZero : true,
											suffix : " 째C"
										},
										legend : {
											cursor : "pointer",
											fontSize : 16,
											itemclick : toggleDataSeries
										},
										toolTip : {
											shared : true
										},
										data : [ {
											name : "Pressure",
											type : "spline",
											yValueFormatString : "#0.## hPa",
											showInLegend : true,
											dataPoints : pressure
										} ]
									});
							chart.render();
						}
					});
		}

/* 		setInterval(function() {
			updateChart()
		}, 30000); */

		function toggleDataSeries(e) {
			if (typeof (e.dataSeries.visible) === "undefined"
					|| e.dataSeries.visible) {
				e.dataSeries.visible = false;
			} else {
				e.dataSeries.visible = true;
			}
			chart.render();
		}
	}
	
</script>
</head>
<body>
	<div id="chartContainer" style="height: 370px; width: 100%;"></div>
	<div id="chartContainer2" style="height: 370px; width: 100%;"></div>
	<div id="chartContainer3" style="height: 370px; width: 100%;"></div>
	
	<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

	<p id="demo"></p>
	<p id="demo2"></p>
</body>
</html>